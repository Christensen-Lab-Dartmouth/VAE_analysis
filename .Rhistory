n8 = ggplot(node8, aes(x = reorder(chr, names))) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 8") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome")
names = as.numeric(substr(node13$chr, 4, 100))
n13 = ggplot(node13, aes(x = reorder(chr, names))) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 13") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome")
grid.arrange(n1, n8, n13, nrow = 1)
names = as.numeric(substr(node1$chr, 4, 100))
n1 = ggplot(node1, aes(x = reorder(chr, names))) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 1") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome")
names = as.numeric(substr(node8$chr, 4, 100))
n8 = ggplot(node8, aes(x = reorder(chr, names))) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 8") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome")
names = as.numeric(substr(node13$chr, 4, 100))
n13 = ggplot(node13, aes(x = reorder(chr, names))) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 13") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome")
grid.arrange(n1, n8, n13, nrow = 1)
n1
ggplot(node1, aes(x = reorder(chr, names))) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 1") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome")
names
length(names)
names = as.numeric(substr(node1$chr, 4, 100))
n1 = ggplot(node1, aes(x = reorder(chr, names))) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 1") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome")
names = as.numeric(substr(node8$chr, 4, 100))
n8 = ggplot(node8, aes(x = reorder(chr, names))) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 8") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome")
names = as.numeric(substr(node13$chr, 4, 100))
n13 = ggplot(node13, aes(x = reorder(chr, names))) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 13") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome")
grid.arrange(n1, n8, n13, nrow = 1)
length(n1)
length(n8)
length(n13)
grid.arrange(n1, n8,  nrow = 1)
?grid.arrange
grid.arrange(n1, n13,  nrow = 1)
grid.arrange(n1, n13)
grid.arrange(n1, n2)
grid.arrange(n1, n8)
grid.arrange(n1, n8, ncol = 2)
grid.arrange(n1, n8, ncol=2)
n8
names
names = as.numeric(substr(node8$chr, 4, 100))
n8 = ggplot(node8, aes(x = reorder(chr, names))) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 8") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome")
n8
names = as.numeric(substr(node13$chr, 4, 100))
n13 = ggplot(node13, aes(x = reorder(chr, names))) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 13") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome")
n13
grid.arrange(n1, n8, n13, ncol=2)
View(node1)
all(colnames(node1) == colnames(node8))
all(colnames(node1) == colnames(node13))
full.data = node1
node1$node = 1
node8$node = 8
node13$node = 13
node16$node = 16
node33$node = 33
node40$node = 40
node48$node = 48
node49$node = 49
node55$node = 55
node56$node = 56
node58$node = 58
node66$node = 66
node68$node = 68
node86$node = 86
node93$node = 93
full.data = rbind(node1, node8, node13, node16, node33,
node40, node48, node49, node55, node56,
node58, node66, node68, node86, node93)
View(full.data)
table(full.data$node)
names = as.numeric(substr(names(table(full.data$chr)), 4, 100))
ggplot(full.data, aes(x = reorder(chr, names))) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 1") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome")
length(names)
names = as.numeric(substr(full.data$chr), 4, 100))
ggplot(full.data, aes(x = reorder(chr, names))) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 1") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome")
names = as.numeric(substr(full.data$chr), 4, 100)
ggplot(full.data, aes(x = reorder(chr, names))) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 1") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome")
names = as.numeric(substr(full.data$chr, 4, 100))
ggplot(full.data, aes(x = reorder(chr, names))) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 1") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome")
ggplot(full.data, aes(x = Relation_to_Island)) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 1") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome")
ggplot(full.data, aes(x = Relation_to_Island)) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 1") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome") +
facet_grid(.~node)
ggplot(full.data, aes(x = Relation_to_Island)) + facet_grid(.~node) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 1") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome")
par(mfrow=c(3,5))
names = as.numeric(substr(node1$chr, 4, 100))
ggplot(node1, aes(x = reorder(chr, names))) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 1") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome")
names = as.numeric(substr(node8$chr, 4, 100))
ggplot(node8, aes(x = reorder(chr, names))) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 8") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome")
names = as.numeric(substr(node13$chr, 4, 100))
ggplot(node13, aes(x = reorder(chr, names))) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 13") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome")
grid.arrange(n1, n8, n13, ncol=2)
grid.arrange(n1, n8, n13)
n1
names = as.numeric(substr(node1$chr, 4, 100))
n1 = ggplot(node1, aes(x = reorder(chr, names))) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 1") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome")
n1
names1 = as.numeric(substr(node1$chr, 4, 100))
n1 = ggplot(node1, aes(x = reorder(chr, names1))) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 1") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome")
names8 = as.numeric(substr(node8$chr, 4, 100))
n8 = ggplot(node8, aes(x = reorder(chr, names8))) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 8") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome")
names13 = as.numeric(substr(node13$chr, 4, 100))
n13 = ggplot(node13, aes(x = reorder(chr, names13))) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 13") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome")
grid.arrange(n1, n8, n13, ncol=2)
grid.arrange(n1, n8, n13, ncol=3)
n1 = ggplot(node1, aes(x = reorder(chr, names1))) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 1") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
n1
names1 = as.numeric(substr(node1$chr, 4, 100))
n1 = ggplot(node1, aes(x = reorder(chr, names1))) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 1") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
names8 = as.numeric(substr(node8$chr, 4, 100))
n8 = ggplot(node8, aes(x = reorder(chr, names8))) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 8") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
names13 = as.numeric(substr(node13$chr, 4, 100))
n13 = ggplot(node13, aes(x = reorder(chr, names13))) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 13") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
grid.arrange(n1, n8, n13, ncol=3)
names16 = as.numeric(substr(node16$chr, 4, 100))
n16 = ggplot(node16, aes(x = reorder(chr, names16))) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 16") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
names33 = as.numeric(substr(node33$chr, 4, 100))
n33 = ggplot(node33, aes(x = reorder(chr, names33))) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 33") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
grid.arrange(n1, n8, n13, n16, n33, ncol=3)
names1 = as.numeric(substr(node1$chr, 4, 100))
n1 = ggplot(node1, aes(x = reorder(chr, names1))) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 1") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
names8 = as.numeric(substr(node8$chr, 4, 100))
n8 = ggplot(node8, aes(x = reorder(chr, names8))) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 8") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
names13 = as.numeric(substr(node13$chr, 4, 100))
n13 = ggplot(node13, aes(x = reorder(chr, names13))) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 13") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
names16 = as.numeric(substr(node16$chr, 4, 100))
n16 = ggplot(node16, aes(x = reorder(chr, names16))) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 16") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
names33 = as.numeric(substr(node33$chr, 4, 100))
n33 = ggplot(node33, aes(x = reorder(chr, names33))) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 33") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
names40 = as.numeric(substr(node40$chr, 4, 100))
n40 = ggplot(node40, aes(x = reorder(chr, names40))) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 40") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
names48 = as.numeric(substr(node48$chr, 4, 100))
n48 = ggplot(node48, aes(x = reorder(chr, names48))) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 48") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
names49 = as.numeric(substr(node49$chr, 4, 100))
n49 = ggplot(node49, aes(x = reorder(chr, names49))) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 49") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
names55 = as.numeric(substr(node55$chr, 4, 100))
n55 = ggplot(node55, aes(x = reorder(chr, names55))) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 55") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
names56 = as.numeric(substr(node56$chr, 4, 100))
n56 = ggplot(node56, aes(x = reorder(chr, names56))) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 56") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
names58 = as.numeric(substr(node58$chr, 4, 100))
n58 = ggplot(node58, aes(x = reorder(chr, names58))) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 58") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
names66 = as.numeric(substr(node66$chr, 4, 100))
n66 = ggplot(node66, aes(x = reorder(chr, names66))) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 66") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
names68 = as.numeric(substr(node68$chr, 4, 100))
n68 = ggplot(node68, aes(x = reorder(chr, names68))) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 68") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
names86 = as.numeric(substr(node86$chr, 4, 100))
n86 = ggplot(node86, aes(x = reorder(chr, names86))) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 86") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
names93 = as.numeric(substr(node93$chr, 4, 100))
n93 = ggplot(node93, aes(x = reorder(chr, names93))) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 93") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
grid.arrange(n1, n8, n13, n16, n33,
n40, n48, n49, n55, n56,
n58, n66, n68, n86, n93, ncol=3)
g = grid.arrange(n1, n8, n13, n16, n33,
n40, n48, n49, n55, n56,
n58, n66, n68, n86, n93, ncol=3)
ggsave(file="nodeCpG_correllation_chr.png", g)
g = grid.arrange(n1, n8, n13, n16, n33,
n40, n48, n49, n55, n56,
n58, n66, n68, n86, n93, ncol=4)
ggsave(file="nodeCpG_correllation_chr.png", g)
ggsave(g, file="nodeCpG_correllation_chr.png", width=4, height=4)
ggsave(g, file="nodeCpG_correllation_chr.png", width=12, height=12)
ggsave(g, file="nodeCpG_correllation_chr.png", width=12, height=16)
ggsave(g, file="nodeCpG_correllation_chr.png", width=16, height=16)
n1 = ggplot(node1, aes(x = Relation_to_Island)) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 1") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per chromosome") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
n1
n8 = ggplot(node8, aes(x = Relation_to_Island)) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 8") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per CpG island context") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
n8
## Plot CpGs by island context
n1 = ggplot(node1, aes(x = Relation_to_Island)) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 1") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per CpG island context") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
n8 = ggplot(node8, aes(x = Relation_to_Island)) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 8") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per CpG island context") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
n13 = ggplot(node13, aes(x = Relation_to_Island)) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 13") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per CpG island context") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
n16 = ggplot(node16, aes(x = Relation_to_Island)) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 16") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per CpG island context") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
n33 = ggplot(node33, aes(x = Relation_to_Island)) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 33") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per CpG island context") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
n40 = ggplot(node40, aes(x = Relation_to_Island)) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 40") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per CpG island context") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
n48 = ggplot(node48, aes(x = Relation_to_Island)) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 48") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per CpG island context") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
n49 = ggplot(node49, aes(x = Relation_to_Island)) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 49") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per CpG island context") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
n55 = ggplot(node55, aes(x = Relation_to_Island)) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 55") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per CpG island context") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
n56 = ggplot(node56, aes(x = Relation_to_Island)) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 56") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per CpG island context") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
n58 = ggplot(node58, aes(x = Relation_to_Island)) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 58") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per CpG island context") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
n66 = ggplot(node66, aes(x = Relation_to_Island)) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 66") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per CpG island context") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
n68 = ggplot(node68, aes(x = Relation_to_Island)) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 68") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per CpG island context") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
n86 = ggplot(node86, aes(x = Relation_to_Island)) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 86") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per CpG island context") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
n93 = ggplot(node93, aes(x = Relation_to_Island)) + geom_bar(aes(y=..count../sum(..count..))) +
scale_y_continuous(labels=percent_format()) + ggtitle("Node 93") +
xlab("Chromosome") + ylab("Proportion of associated CpGs per CpG island context") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
g = grid.arrange(n1, n8, n13, n16, n33,
n40, n48, n49, n55, n56,
n58, n66, n68, n86, n93, ncol=4)
ggsave(g, file="nodeCpG_correllation_relationToisland.png", width=16, height=16)
ggplot(results, aes(x=beta, y=negLog10P)) + geom_point()
### Setup the environment we need ###
source("https://bioconductor.org/biocLite.R")
# biocLite("qvalue")
# install.packages('glmnet')
# install.packages('data.table')
require(glmnet)
require(data.table)
library(limma)
library(qvalue)
#dir = '/Users/alexandertitus/Documents/github/DNAm_data_generation/code'
dir = 'C:/Users/atitus/Documents/github/DNAm_data_generation/results'
setwd(dir)
# Load all the data and make variables
### Load our data to work with ###
vae.file = 'encoded_methyl_onehidden_warmup_batchnorm_300K-100.tsv'
BRCA.covFile = '../BRCAtarget_covariates.csv'
tSNE.file = '../results/tSNE/vae_tsne_out_300K-100_3d.tsv'
tSNE_features = data.frame(fread(tSNE.file), row.names=1)
colnames(tSNE_features) = tSNE_features[1, ]
tSNE_features = tSNE_features[2:nrow(tSNE_features), ]
tSNE_features$Basename = rownames(tSNE_features)
vae_features = data.frame(fread(vae.file), row.names=1)
colnames(vae_features) = vae_features[1, ]
vae_features = vae_features[2:nrow(vae_features), ]
vae_features$Basename = rownames(vae_features)
BRCA.covs = data.frame(fread(BRCA.covFile), row.names=1)
BRCA.covs$sample.typeInt = ifelse(BRCA.covs$sample.type == 'Solid Tissue Normal', 0, 1)
full.data = merge(vae_features, BRCA.covs, by='Basename')
full.data = merge(full.data, tSNE_features, by='Basename')
full.data$BasalVother = ifelse(full.data$PAM50.RNAseq == "Basal", 1, 0)
full.data$NormalVother = ifelse(full.data$PAM50.RNAseq == "Normal", 1, 0)
full.data$Her2Vother = ifelse(full.data$PAM50.RNAseq == "Her2", 1, 0)
full.data$LumAVother = ifelse(full.data$PAM50.RNAseq == "LumA", 1, 0)
full.data$LumBVother = ifelse(full.data$PAM50.RNAseq == "LumB", 1, 0)
full.data$LumVother = ifelse(full.data$PAM50.RNAseq == "LumA" |
full.data$PAM50.RNAseq == "LumB", 1, 0)
## LaWAS
# Create our model matrix
BRCA.covsSub = BRCA.covs[!is.na(BRCA.covs$age.Dx), ]
vae_featuresSub = vae_features[rownames(vae_features) %in% BRCA.covsSub$Basename,]
XX <- model.matrix(~sample.typeInt + age.Dx, data = BRCA.covsSub)
rownames(XX) <- BRCA.covsSub$Basename
XX = XX[order(rownames(XX), decreasing=T), ]
vae = vae_featuresSub[order(rownames(vae_featuresSub), decreasing=T), ]
vae = vae[, 1:ncol(vae)-1]
vae_mat <- data.matrix(vae)
## M-values
betas_dmgrM = vae_mat # ifelse(vae_mat>=1, 1-1E-6, ifelse(vae_mat<=0, 1E-6, vae_mat))
#betas_dmgrM <- log(betas_dmgrM)-log(1-betas_dmgrM)
betas_dmgrM = t(betas_dmgrM)
betas_dmgrM2 <- betas_dmgrM[, colnames(betas_dmgrM) %in% rownames(XX)]
all(colnames(betas_dmgrM2) == rownames(XX))
# Limma models
lf_Null <- eBayes(lmFit(betas_dmgrM2, XX))
# Limma Models - correlation = ar1
library(nlme)
subjectList <- BRCA.covsSub$Basename[order(BRCA.covsSub$Basename,decreasing = T)]
corStructure <- corAR1(form = ~ 1 | subjectList)
lf_Null <- eBayes(lmFit(betas_dmgrM2, XX, block = subjectList, correlation = corStructure))
# Analysis of q-values
q.values <- qvalue(lf_Null$p.value[,2], lambda = seq(0.0, 0.55, 0.05))
results <- cbind(q.values$pvalues, q.values$qvalues, lf_Null$coefficients[, 2])
# Name the rows and columns for each model
colnames(results) <- colnames(results) <- c("pvalues", "qvalues", "beta")
results = data.frame(results)
# print out summary of the adjusted and unadjusted results
summary(q.values)
#### Generate the theme of each ggplot ####
results$negLog10P = -log(results$pvalues)
results$Nodes = rownames(results)
library(ggpubr)
ggplot(results, aes(x=beta, y=negLog10P)) + geom_point()
View(results)
ggplot(results, aes(x=beta, y=negLog10P)) + geom_point() +
geom_text(label=Nodes)
View(results)
ggplot(results, aes(x=beta, y=negLog10P)) + geom_point() +
geom_text(label=results$Nodes)
ggplot(results, aes(x=beta, y=negLog10P)) + geom_point(size=2) +
geom_text(label=results$Nodes)
shiny::runApp('~/github/Geo_Cell_Proportions_Shiny')
install.packages('shinydashboard')
runApp('~/github/Geo_Cell_Proportions_Shiny')
install.packages('tidyverse')
runApp('~/github/Geo_Cell_Proportions_Shiny')
install.packages(shinythemes)
install.packages('shinythemes')
runApp('~/github/Geo_Cell_Proportions_Shiny')
install.packages('DT')
runApp('~/github/Geo_Cell_Proportions_Shiny')
ggplot(temp, aes(x = reorder(Node, Activation, FUN = median), y = Activation, fill = SampleTypeInt)) +
geom_boxplot() + facet_grid(SampleTypeInt ~ .) + xlab("Node") +
ylab("Latent node activation value")
ggplot(temp, aes(x = reorder(Node, Activation, FUN = median), y = Activation, fill = SampleTypeInt)) +
geom_boxplot() + xlab("Node") + #facet_grid(SampleTypeInt ~ .) +
ylab("Latent node activation value")
ggplot(temp, aes(x = reorder(Node, Activation, FUN = median), y = Activation, fill = PAM50orNormal)) +
geom_boxplot(position=position_dodge(width=0.8)) + facet_grid(PAM50orNormal ~ .) + xlab("Node") +
ylab("Latent node activation value")
ggplot(temp, aes(x = reorder(Node, Activation, FUN = median), y = Activation, fill = SampleTypeInt)) +
geom_boxplot(position=position_dodge(width=0.8)) + xlab("Node") + #facet_grid(SampleTypeInt ~ .) +
ylab("Latent node activation value")
ggplot(temp, aes(x = reorder(Node, Activation, FUN = median), y = Activation, fill = SampleTypeInt)) +
geom_boxplot(position=position_dodge(width=4.8)) + xlab("Node") + #facet_grid(SampleTypeInt ~ .) +
ylab("Latent node activation value")
ggplot(temp, aes(x = reorder(Node, Activation, FUN = median), y = Activation, fill = SampleTypeInt)) +
geom_boxplot(width=0.5) + xlab("Node") + #facet_grid(SampleTypeInt ~ .) +
ylab("Latent node activation value")
ggplot(temp, aes(x = reorder(Node, Activation, FUN = median), y = Activation, fill = SampleTypeInt)) +
geom_boxplot(width=1.5) + xlab("Node") + #facet_grid(SampleTypeInt ~ .) +
ylab("Latent node activation value")
ggplot(temp, aes(x = reorder(Node, Activation, FUN = median), y = Activation, fill = SampleTypeInt)) +
geom_boxplot(width=0.5) + xlab("Node") + #facet_grid(SampleTypeInt ~ .) +
ylab("Latent node activation value")
library(ggpubr)
png('Node_activationsInt.png', width = 2000, height = 2000, res = 300)
ggplot(temp, aes(x = reorder(Node, Activation, FUN = median), y = Activation, fill = SampleTypeInt)) +
geom_boxplot(width=0.5) + xlab("Node") + #facet_grid(SampleTypeInt ~ .) +
ylab("Latent node activation value")
dev.off()
png('Node_activationsInt.png', width = 2000, height = 2000, res = 300)
ggplot(temp, aes(x = reorder(Node, Activation, FUN = median), y = Activation, fill = SampleTypeInt)) +
geom_boxplot() + xlab("Node") + #facet_grid(SampleTypeInt ~ .) +
ylab("Latent node activation value")
dev.off()
ggplot(temp, aes(x = reorder(Node, Activation, FUN = median), y = Activation, fill = SampleTypeInt)) +
geom_boxplot(alpha = 0.3, width=0.5) + xlab("Node") + #facet_grid(SampleTypeInt ~ .) +
ylab("Latent node activation value")
png('Node_activationsInt.png', width = 2000, height = 2000, res = 300)
ggplot(temp, aes(x = reorder(Node, Activation, FUN = median), y = Activation, fill = SampleTypeInt)) +
geom_boxplot(width=0.5) + xlab("Node") + #facet_grid(SampleTypeInt ~ .) +
ylab("Latent node activation value")
dev.off()
temp = temp[temp$PAM50 != '', ]
png('Node_activationsPAM50.png', width = 3000, height = 2000, res = 300)
ggplot(temp, aes(x = reorder(Node, Activation, FUN = median), y = Activation, fill = PAM50orNormal)) +
geom_boxplot(alpha = 0.3, width=0.5) + xlab("Node") + #facet_grid(PAM50orNormal ~ .) +
ylab("Latent node activation value")
dev.off()
ggplot(temp, aes(x = reorder(Node, Activation, FUN = median), y = Activation, fill = SampleTypeInt)) +
geom_boxplot(width=0.5) + xlab("Node") + #facet_grid(SampleTypeInt ~ .) +
ylab("Latent node activation value") +
scale_x_discrete(limits=c(8,4,6))
ggplot(temp, aes(x = reorder(Node, Activation, FUN = median), y = Activation, fill = SampleTypeInt)) +
geom_boxplot(width=0.5) + xlab("Node") + #facet_grid(SampleTypeInt ~ .) +
ylab("Latent node activation value") +
scale_x_discrete(limits=c(13, 40, 93))
ggplot(temp, aes(x = reorder(Node, Activation, FUN = median), y = Activation, fill = SampleTypeInt)) +
geom_boxplot(width=0.5) +  #facet_grid(SampleTypeInt ~ .) +
ylab("Latent node activation value") +
scale_x_discrete(limits=c(13, 40, 93)) + xlab("Node")
ggplot(temp, aes(x = reorder(Node, Activation, FUN = median), y = Activation, fill = SampleTypeInt)) +
geom_boxplot(width=0.5) +  #facet_grid(SampleTypeInt ~ .) +
ylab("Latent node activation value") +
scale_x_discrete(limits=c(13, 40, 93)) + xlab("Node")
ggplot(temp, aes(x = reorder(Node, Activation, FUN = median), y = Activation, fill = SampleTypeInt)) +
geom_boxplot(width=0.5) + xlab("Node") + #facet_grid(SampleTypeInt ~ .) +
ylab("Latent node activation value") +
scale_x_discrete(limits=c(66, 55, 13, 40, 93))
ggplot(temp, aes(x = reorder(Node, Activation, FUN = median), y = Activation, fill = SampleTypeInt)) +
geom_boxplot(width=0.5) + xlab("Node") + #facet_grid(SampleTypeInt ~ .) +
ylab("Latent node activation value") +
scale_x_discrete(limits=c(66, 55, 13, 40, 93)) + labs(x = "Node")
setwd('../')
